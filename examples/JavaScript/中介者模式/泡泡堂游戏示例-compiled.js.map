{"version":3,"sources":["泡泡堂游戏示例.js"],"names":[],"mappings":"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","file":"泡泡堂游戏示例-compiled.js","sourcesContent":["/**\r\n * Created by laixiangran@163.com on 2016/5/16\r\n * homepage：http://www.laixiangran.cn\r\n * 泡泡堂游戏\r\n */\r\n\r\n// 玩家类\r\nfunction Player(name, teamColor) {\r\n    this.state = 'live';  // 玩家状态\r\n    this.name = name; // 角色名字\r\n    this.teamColor = teamColor; // 队伍颜色\r\n}\r\n\r\nPlayer.prototype.win = function(){\r\n    console.log( this.name + ' won ' );\r\n};\r\n\r\nPlayer.prototype.lose = function(){\r\n    console.log( this.name +' lost' );\r\n};\r\n\r\n/*******************玩家死亡*****************/\r\n\r\nPlayer.prototype.die = function(){\r\n    this.state = 'dead';\r\n    playerDirector.ReceiveMessage( 'playerDead', this );   // 给中介者发送消息，玩家死亡\r\n};\r\n\r\n/*******************移除玩家*****************/\r\n\r\nPlayer.prototype.remove = function(){\r\n    playerDirector.ReceiveMessage( 'removePlayer', this );    // 给中介者发送消息，移除一个玩家\r\n};\r\n\r\n/*******************玩家换队*****************/\r\n\r\nPlayer.prototype.changeTeam = function( color ){\r\n    playerDirector.ReceiveMessage( 'changeTeam', this, color );   // 给中介者发送消息，玩家换队\r\n};\r\n\r\n// 玩家工厂\r\nvar playerFactory = function( name, teamColor ){\r\n    var newPlayer = new Player( name, teamColor );    // 创造一个新的玩家对象\r\n    playerDirector.ReceiveMessage( 'addPlayer', newPlayer );   // 给中介者发送消息，新增玩家\r\n    return newPlayer;\r\n};\r\n\r\n// 中介者对象\r\nvar playerDirector = ( function(){\r\n    var players = {},   // 保存所有玩家\r\n        operations = {};   // 中介者可以执行的操作\r\n\r\n    /****************新增一个玩家***************************/\r\n    operations.addPlayer = function( player ){\r\n        var teamColor = player.teamColor;   // 玩家的队伍颜色\r\n        players[ teamColor ] = players[ teamColor ] || [];   // 如果该颜色的玩家还没有成立队伍，则新成立一个队伍\r\n\r\n        players[ teamColor ].push( player );   // 添加玩家进队伍\r\n    };\r\n    /****************移除一个玩家***************************/\r\n    operations.removePlayer = function( player ){\r\n        var teamColor = player.teamColor,   // 玩家的队伍颜色\r\n            teamPlayers = players[ teamColor ] || [];   // 该队伍所有成员\r\n        for ( var i = teamPlayers.length - 1; i >= 0; i-- ){   // 遍历删除\r\n            if ( teamPlayers[ i ] === player ){\r\n                teamPlayers.splice( i, 1 );\r\n            }\r\n        }\r\n    };\r\n\r\n    /****************玩家换队***************************/\r\n    operations.changeTeam = function( player, newTeamColor ){   // 玩家换队\r\n        operations.removePlayer( player );   // 从原队伍中删除\r\n        player.teamColor = newTeamColor;   // 改变队伍颜色\r\n        operations.addPlayer( player );       // 增加到新队伍中\r\n    };\r\n\r\n    operations.playerDead = function( player ){     // 玩家死亡\r\n        var teamColor = player.teamColor,\r\n            teamPlayers = players[ teamColor ];   // 玩家所在队伍\r\n\r\n        var all_dead = true;\r\n\r\n        for ( var i = 0, player; player = teamPlayers[ i++ ]; ){\r\n            if ( player.state !== 'dead' ){\r\n                all_dead = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if ( all_dead === true ){   // 全部死亡\r\n\r\n            for ( var i = 0, player; player = teamPlayers[ i++ ]; ){\r\n                player.lose();   // 本队所有玩家lose\r\n            }\r\n\r\n            for ( var color in players ){\r\n                if ( color !== teamColor ){\r\n                    var teamPlayers = players[ color ];   // 其他队伍的玩家\r\n                    for ( var i = 0, player; player = teamPlayers[ i++ ]; ){\r\n                        player.win();   // 其他队伍所有玩家win\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    var ReceiveMessage = function(){\r\n        var message = Array.prototype.shift.call( arguments );   // arguments的第一个参数为消息名称\r\n        operations[ message ].apply( this, arguments );\r\n    };\r\n\r\n    return {\r\n        ReceiveMessage: ReceiveMessage\r\n    }\r\n\r\n})();\r\n\r\n// 红队：\r\nvar player1 = playerFactory( '皮蛋', 'red' ),\r\n    player2 = playerFactory( '小乖', 'red' ),\r\n    player3 = playerFactory( '宝宝', 'red' ),\r\n    player4 = playerFactory( '小强', 'red' );\r\n\r\n// 蓝队：\r\nvar player5 = playerFactory( '黑妞', 'blue' ),\r\n    player6 = playerFactory( '葱头', 'blue' ),\r\n    player7 = playerFactory( '胖墩', 'blue' ),\r\n    player8 = playerFactory( '海盗', 'blue' );\r\n\r\n// 分开运行\r\n// 全队死亡\r\nconsole.log(\"------------------全队死亡-------------------\");\r\nplayer1.die();\r\nplayer2.die();\r\nplayer3.die();\r\nplayer4.die();\r\nconsole.log(\"-------------------------------------\");\r\n\r\n// 皮蛋和小乖掉线\r\nconsole.log(\"------------------皮蛋和小乖掉线-------------------\");\r\nplayer1.remove();\r\nplayer2.remove();\r\nplayer3.die();\r\nplayer4.die();\r\nconsole.log(\"-------------------------------------\");\r\n\r\n// 皮蛋从红队叛变到蓝队\r\nconsole.log(\"------------------皮蛋从红队叛变到蓝队-------------------\");\r\nplayer1.changeTeam( 'blue' );\r\nplayer2.die();\r\nplayer3.die();\r\nplayer4.die();\r\nconsole.log(\"-------------------------------------\");\r\n\r\n"]}